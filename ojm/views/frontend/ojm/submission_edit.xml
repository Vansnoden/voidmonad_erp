<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_edit_submission" name="OJM Edit Submission">
        <t t-call="ojm.ojm_base">
            <t t-call='ojm.navigation' />
            <div class="content-wrapper" style="height:inherit">
                <div class="content-header">
                    <div class="container-fluid">
                        <div class="row mb-2">
                            <div class="col-sm-6">
                                <h1 class="m-0"></h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item">
                                        <a href="#"></a>
                                    </li>
                                    <li class="breadcrumb-item active">Edit submission</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
                <section class="content">
                    <div class="container-fluid row m-auto py-3">
                        <div class="row">
                            <form target="frame" class="needs-validation" id="submission-form" method="post"
                                t-attf-action='/ojm/{{journal.id}}/submit_data' enctype="multipart/form-data">
                                <input type="hidden" name="csrf_token"
                                    t-att-value="request.csrf_token()" />
                                <input type="hidden" id="journal_id" name="journal_id"
                                    t-att-value="journal.id" />
                                <input type="hidden" id="submission_id" name="submission_id" t-att-value="submission.id"/>
                                <div class="col-md-12">
                                    <div class="card card-default">
                                        <div class="card-header py-0">
                                            <div class="row p-0">
                                                <div class="p-3 col-md-4 col-sm-12 border-right text-center bg-primary">
                                                    <h3 class="card-title">  New submission</h3>
                                                </div>
                                                <div class="p-3 col-md-4 col-sm-12 border-right text-center">
                                                    <h3 class="card-title">Preview</h3>
                                                </div>
                                                <div class="p-3 col-md-4 col-sm-12 text-center">
                                                    <h3 class="card-title">Submitted</h3>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card-body p-0">
                                            <div class="bs-stepper" id="stepperForm">
                                                <div class="bs-stepper-header px-3 d-flex flex-md-row flex-sm-column justify-content-start align-items-left" role="tablist">
                                                    <!-- your steps here -->
                                                    <div class="step"
                                                        data-target="#article-type-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab"
                                                            aria-controls="article-type-part"
                                                            id="article-type-part-trigger">
                                                            <span class="bs-stepper-circle">1</span>
                                                            <span class="bs-stepper-label">Select
                                                                Article Type</span>
                                                        </button>
                                                    </div>
                                                    <div class="line"></div>
                                                    <div class="step"
                                                        data-target="#attach-file-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab"
                                                            aria-controls="attach-file-part"
                                                            id="attach-file-part-trigger">
                                                            <span class="bs-stepper-circle">2</span>
                                                            <span class="bs-stepper-label">Attach
                                                                Files</span>
                                                        </button>
                                                    </div>
                                                    <div class="line"></div>
                                                    <div class="step"
                                                        data-target="#general-information-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab"
                                                            aria-controls="general-information-part"
                                                            id="general-information-part-trigger">
                                                            <span class="bs-stepper-circle">3</span>
                                                            <span class="bs-stepper-label">General
                                                                Information</span>
                                                        </button>
                                                    </div>
                                                    <div class="line"></div>
                                                    <div class="step"
                                                        data-target="#review-preferences-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab"
                                                            aria-controls="review-preferences-part"
                                                            id="review-preferences-part-trigger">
                                                            <span class="bs-stepper-circle">4</span>
                                                            <span class="bs-stepper-label">Review
                                                                preferences</span>
                                                        </button>
                                                    </div>
                                                    <div class="line"></div>
                                                    <!-- <div class="step"
                                                        data-target="#additional-information-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab"
                                                            aria-controls="additional-information-part"
                                                            id="additional-information-part-trigger">
                                                            <span class="bs-stepper-circle">5</span>
                                                            <span class="bs-stepper-label">Additional
                                                                Information</span>
                                                        </button>
                                                    </div>
                                                    <div class="line"></div>
                                                    <div class="step" data-target="#comments-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab" aria-controls="comments-part"
                                                            id="comments-part-trigger">
                                                            <span class="bs-stepper-circle">6</span>
                                                            <span class="bs-stepper-label">Comments</span>
                                                        </button>
                                                    </div>
                                                    <div class="line"></div> -->
                                                    <div class="step"
                                                        data-target="#manuscript-data-part">
                                                        <button type="button" class="step-trigger"
                                                            role="tab"
                                                            aria-controls="manuscript-data-part"
                                                            id="manuscript-data-part-trigger">
                                                            <span class="bs-stepper-circle">5</span>
                                                            <span class="bs-stepper-label">Manuscript
                                                                data</span>
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="bs-stepper-content mt-4">
                                                    <!-- your steps content here -->
                                                    <div id="article-type-part" class="content bs-stepper-pane"
                                                        role="tabpanel"
                                                        aria-labelledby="article-type-part-trigger">
                                                        <div class="col-md-8 col-sm-12 p-2">
                                                            <div class="card  p-2">
                                                                <t t-foreach="atypes" t-as="type">
                                                                    <u><b><t t-esc='type.name'/></b></u>
                                                                    <p class='text-justify'>
                                                                        <t t-esc='type.description'/>
                                                                    </p>
                                                                </t>
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="article_type">Select Article type <span class="required-field">*</span></label>
                                                                <select
                                                                    id="article_type"
                                                                    class="form-control article_type_selector"
                                                                    style="width: 100%;" name='atype' required="true" t-att-value="submission.type_id">
                                                                    <t t-foreach="atypes"
                                                                        t-as="type">
                                                                        <option
                                                                            t-att-value='type.id'>
                                                                            <t t-esc='type.name' />
                                                                        </option>
                                                                    </t>
                                                                </select>
                                                                <div class="invalid-feedback">Please select the type of article</div>
                                                            </div>
                                                        </div>
                                                        <button type="button"
                                                            class="btn btn-primary next-step-btn"
                                                            onclick="stepper.next()">Next</button>
                                                    </div>
                                                    <div id="attach-file-part" class="content"
                                                        role="tabpanel"
                                                        aria-labelledby="attach-file-part-trigger">
                                                        <div class='row'>
                                                            <div class='col-md-9'>
                                                                <div class="col-md-12">
                                                                    <div class="card card-default">
                                                                        <div class="card-header">
                                                                            <h3 class="card-title">
                                                                                Dropzone
                                                                            </h3>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <div class="form-group">
                                                                                <label for="others">
                                                                                    Additionnal documents
                                                                                </label><br/>
                                                                                <!-- <button type="button" data-bs-toggle="modal" data-bs-target="#fileModal" class="btn btn-primary">Add file</button> -->
                                                                                <button type="button" class="btn btn-default" data-toggle="modal" data-target="#modal-upload-attachments">
                                                                                    Add file
                                                                                </button>
                                                                                <div>
                                                                                    <!-- javascript will add a table at this level -->
                                                                                    
                                                                                    <table class="table table-striped" id="file_table">
                                                                                        <tr>
                                                                                            <th>Name</th>
                                                                                            <th>Size</th>
                                                                                            <th>File type</th>
                                                                                        </tr>
                                                                                        <t t-foreach="submission.document_ids" t-as="doc">
                                                                                            <tr>
                                                                                                <td><t t-esc="doc.name"/></td>
                                                                                                <td><t t-esc="doc.file_size"/></td>
                                                                                                <td><t t-esc="doc.mimetype"/></td>
                                                                                            </tr>
                                                                                        </t>
                                                                                        <!-- <tr><th>Name</th><th>Size</th><th>File type</th></tr> -->
                                                                                    </table>
                                                                                </div>
                                                                                <!-- <input type='file' multiple='true' name="others" class="form-control" accept=".docx,.doc,.pdf,.rtf,.png,.xlsx,.jpg,.jpeg,.gif,.zip,.rar"/> -->
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class='col-md-3'> Upload submission
                                                                files individually <ul>
                                                                    <!-- <li>Cover letter</li> -->
                                                                    <li>Manuscript</li>
                                                                    <!-- <li>Figures</li> -->
                                                                    <li>Other documents (Cover letters, Figures, data, etc.)</li>
                                                                </ul>
                                                                <p> 
                                                                    Accepted manuscript formats are:
                                                                    DOC, DOCX, or RTF. Editorial
                                                                    Manager will extract information
                                                                    from the manuscript to fill in
                                                                    details under Manuscript Data.
                                                                    Submit LaTeX manuscripts in PDF.
                                                                </p>        
                                                                <p>
                                                                    Please note our system has a maximum
                                                                    file size limit. For the convenience
                                                                    of our editors and reviewers, we    
                                                                    kindly ask that you keep all submission
                                                                    files under 10MB where possible,
                                                                    and recommend that larger files be
                                                                    uploaded to a data repository.
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="stepper.previous()">Previous</button>
                                                        <button type="button"
                                                            class="btn btn-primary next-step-btn"
                                                            onclick="stepper.next()">Next</button>
                                                    </div>

                                                    <div id="general-information-part"
                                                        class="content"
                                                        role="tabpanel"
                                                        aria-labelledby="general-information-part-trigger">
                                                        <div class="col-md-8 col-sm-12">
                                                            <div class="card  p-2">
                                                                <t t-foreach="journal.section_ids" t-as="section">
                                                                    <u><b><t t-esc='section.name'/></b></u>
                                                                    <p class='text-justify'>
                                                                        <t t-raw='section.description'/>
                                                                    </p>
                                                                </t>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>Select the section or category appropriate to your manuscript. <span class="required-field">*</span></label>
                                                                <select
                                                                    class="form-control journal_section_selector"
                                                                    style="width: 100%;" name="journal_section" required="true" t-att-value="submission.section_id">
                                                                    <t
                                                                        t-foreach="journal.section_ids"
                                                                        t-as="journal">
                                                                        <option
                                                                            t-att-value='journal.id'>
                                                                            <t t-esc='journal.name' />
                                                                        </option>
                                                                    </t>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="stepper.previous()">Previous</button>
                                                        <button type="button"
                                                            class="btn btn-primary next-step-btn"
                                                            onclick="stepper.next()">Next</button>
                                                    </div>

                                                    <div id="review-preferences-part"
                                                        class="content"
                                                        role="tabpanel"
                                                        aria-labelledby="review-preferences-part-trigger">
                                                        <div class='row mb-3'>
                                                            <div class="col-md-9 col-sm-12">
                                                                <div id="reviewers">
                                                                    <div class="single-reviewer row" id="review_1">
                                                                        <div class="col-md-6 col-sm-10 col-xs-12">
                                                                            <div class="form-group">
                                                                                <label for="reviewer_email_1">Email <span class="required-field">*</span></label>
                                                                                <input type="email" class="form-control" id="reviewer_email_1" required="true" name="reviewer_email_1"/>
                                                                            </div>
                                                                            <div class="d-flex flex-row align-items-center justify-content-between" style="gap:0.5em;">
                                                                                <div class="form-group">
                                                                                    <label for="reviewer_fname_1">First name <span class="required-field">*</span></label>
                                                                                    <input type="text" class="form-control" id="reviewer_fname_1" required="true" name="reviewer_fname_1"/>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label for="reviewer_mname_1">Middle name </label>
                                                                                    <input type="text" class="form-control" id="reviewer_mname_1" name="reviewer_mname_1"/>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label for="reviewer_lname_1">Last name <span class="required-field">*</span></label>
                                                                                    <input type="text" class="form-control" id="reviewer_lname_1" required="true" name="reviewer_lname_1"/>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-5 col-sm-10 col-xs-12">
                                                                            <div class="form-group">
                                                                                <label for="reviewer_title_1">Title</label>
                                                                                <select class="form-control" id="reviewer_title_1" name="reviewer_title_1">
                                                                                    <option value="Mr">Mr</option>
                                                                                    <option value="Mrs">Mrs</option>
                                                                                    <option value="Dr">Dr</option>
                                                                                    <option value="Pr">Pr</option>
                                                                                </select>
                                                                            </div>
                                                                            <div class="form-group">
                                                                                <label for="reviewer_comment_1">Comment</label>
                                                                                <textarea class="form-control" id="reviewer_comment_1" name="reviewer_comment_1" rows="3" cols="8"> </textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-1 col-sm-10 col-xs-12">
                                                                            <button type='button' class="btn btn-danger" id="close_reviewer_1">
                                                                                <span class="fa fa-trash"></span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-sm-12 p-3">
                                                                <div class="mt-3 d-flex flex-row justify-content-start align-items-center">
                                                                    <button type='button' class="btn btn-primary" id="add_reviewer">
                                                                        Add reviewer
                                                                    </button>
                                                                </div>
                                                                <div class="border-top mt-2">
                                                                    <p>
                                                                        Name any opposed ACADEMIC EDITORS or REVIEWERS. The journal 
                                                                        will accommodate requests where possible. In some cases, Sayans 
                                                                        may need to contact opposed individuals.
                                                                        <ul>
                                                                            <li>
                                                                                Enter as much information as possible so that we can 
                                                                                identify the correct person
                                                                            </li>
                                                                            <li>
                                                                                Provide a reason for excluding each person
                                                                            </li>
                                                                            <li>
                                                                                Check each name against the Sayans Editorial Board, and indicate 
                                                                                whether the individual is an editor or reviewer
                                                                            </li>
                                                                        </ul>
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="stepper.previous()">Previous</button>
                                                        <button type="button"
                                                            class="btn btn-primary next-step-btn"
                                                            onclick="stepper.next()">Next</button>
                                                    </div>

                                                    <!-- <div id="additional-information-part"
                                                        class="content"
                                                        role="tabpanel"
                                                        aria-labelledby="additional-information-part-trigger"> -->
                                                        <!-- content here -->
                                                        <!-- <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="stepper.previous()">Previous</button>
                                                        <button type="button"
                                                            class="btn btn-primary next-step-btn"
                                                            onclick="stepper.next()">Next</button>
                                                    </div> -->

                                                    <!-- <div id="comments-part" class="content"
                                                        role="tabpanel"
                                                        aria-labelledby="comments-part-trigger"> -->
                                                        <!-- content here -->
                                                        <!-- <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="stepper.previous()">Previous</button>
                                                        <button type="button"
                                                            class="btn btn-primary next-step-btn"
                                                            onclick="stepper.next()">Next</button>
                                                    </div> -->


                                                    <div id="manuscript-data-part" class="content"
                                                        role="tabpanel"
                                                        aria-labelledby="manuscript-data-part-trigger">
                                                        <!-- content here -->
                                                        <div class="card">
                                                            <div class="card-header">
                                                                <h3>Title</h3>
                                                            </div>
                                                            <div class="card-body">
                                                                <label for='article_full_title'>Full title <span class="required-field">*</span></label>
                                                                <textarea id="article_full_title" name="article_full_title">
                                                                    <t t-raw="submission.name"/>
                                                                </textarea>
                                                                <!-- <div class="form-group">
                                                                    <label for="short_title">Short title </label>
                                                                    <textarea class="form-control" rows="3" cols="8" id="short_title" name="short_title"> </textarea>
                                                                </div> -->
                                                            </div>
                                                        </div>
                                                        <div class="card">
                                                            <div class="card-header">
                                                                <h3>Abstract</h3>
                                                            </div>
                                                            <div class="card-body">
                                                                <label for='article_abstract'>Abstract <span class="required-field">*</span></label>
                                                                <textarea id="article_abstract" name="article_abstract">
                                                                    <t t-raw="submission.abstract"/>
                                                                </textarea>
                                                            </div>
                                                        </div>
                                                        <div class="card">
                                                            <div class="card-header">
                                                                <h3>Keywords</h3>
                                                            </div>
                                                            <div class="card-body">
                                                                <div class="form-group">
                                                                    <label for="keywords">Provide keywords separated by semi-columns (;) <span class="required-field">*</span></label>
                                                                    <textarea class="form-control" rows="3" cols="8" id="keywords" name="keywords"> </textarea>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card">
                                                            <div class="card-header">
                                                                <h3>Authors</h3>
                                                            </div>
                                                            <div class="card-body">
                                                                <div id="authors">
                                                                    <div class="single-author row" id="author_1">
                                                                        <div class="col-md-6 col-sm-10 col-xs-12">
                                                                            <div class="form-group">
                                                                                <label for="author_email_1">Email <span class="required-field">*</span></label>
                                                                                <input type="email" class="form-control" id="author_email_1" name="author_email_1"/>
                                                                            </div>
                                                                            <div class="d-flex flex-row align-items-center justify-content-between" style="gap:0.5em;">
                                                                                <div class="form-group">
                                                                                    <label for="author_fname_1">First name <span class="required-field">*</span> </label>
                                                                                    <input type="text" class="form-control" id="author_fname_1" name="author_fname_1"/>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label for="author_mname_1">Middle name </label>
                                                                                    <input type="text" class="form-control" id="author_mname_1" name="author_mname_1"/>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label for="author_lname_1">Last name <span class="required-field">*</span></label>
                                                                                    <input type="text" class="form-control" id="author_lname_1" name="author_lname_1"/>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-5 col-sm-10 col-xs-12">
                                                                            <div class="form-group">
                                                                                <label for="author_title_1">Title </label>
                                                                                <select class="form-control" id="author_title_1" name="author_title_1">
                                                                                    <option value="Mr">Mr</option>
                                                                                    <option value="Mrs">Mrs</option>
                                                                                    <option value="Dr">Dr</option>
                                                                                    <option value="Pr">Pr</option>
                                                                                </select>
                                                                            </div>
                                                                            <div class="form-group">
                                                                                <label for="author_aff_1">Affiliation </label>
                                                                                <input type="text" class="form-control" id="author_aff_1" name="author_aff_1"/>
                                                                            </div>
                                                                            <div class="form-group">
                                                                                <label for="author_order_1">Sequence (the priority of the author, the lower the greater)<span class="required-field">*</span></label>
                                                                                <input type="number" min="0" step="1" class="form-control" id="author_order_1" name="author_order_1"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-1 col-sm-10 col-xs-12">
                                                                            <a href="#" class="btn btn-danger" id="close_author_1">
                                                                                <span class="fa fa-trash"></span>
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="mt-3 d-flex flex-row justify-content-start align-items-center p-0">
                                                                    <button type="button" class="btn btn-primary" id="add_author">
                                                                        Add author
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card">
                                                            <div class="card-header">
                                                                <h3>Funding Information</h3>
                                                            </div>
                                                            <div class="card-body">

                                                            </div>
                                                        </div>
                                                        <button type="button"
                                                            class="btn btn-primary"
                                                            onclick="stepper.previous()">Previous</button>
                                                        <button type='submit' class='btn btn-primary'>
                                                            Save changes
                                                        </button>
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <div>
                                <!-- modals -->
                                <!-- <div class="modal fade" id="fileModal" tabindex="-1" role="dialog" aria-labelledby="fileModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="fileModalLabel">Modal title</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">x</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            ...
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            <button type="button" class="btn btn-primary">Save changes</button>
                                        </div>
                                        </div>
                                    </div> -->
                                <!-- </div> -->
                                <div class="modal fade" id="modal-upload-attachments">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <form target="frame" name="uploadForm" id="form-upload" method="post" t-attf-action="/ojm/upload_files" enctype="multipart/form-data">
                                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                                                <div class="modal-header">
                                                <h4 class="modal-title">Upload document</h4>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true" class="fa fa-close"></span>
                                                </button>
                                                </div>
                                                <div class="modal-body">
                                                    <p>
                                                        You can add all your files one by one, or you can just upload a <b>zip</b>
                                                        of all your data.
                                                    </p>
                                                    <input type="hidden" id="submission_id_upload" name="submission_id" t-att-value="0"/>
                                                    <label for="doctype">Select document type</label><br/>
                                                    test text
                                                    <select id="doctype" name="doctype" required="true">
                                                        <t t-foreach="article_doctypes" t-as="doctype">
                                                            <option t-att-value="doctype.name">
                                                                <t t-esc="doctype.name"/>
                                                            </option>
                                                        </t>
                                                    </select>
                                                    <br/>
                                                    <label for="other_attachment">Select document</label><br/>
                                                    <input type="file" name="other_attachment" id="other_attachment" required="true"/>
                                                    <br/>
                                                    <div class="alert alert-info d-none mt-2" id="info-box">
                                                        Upload another document or close.
                                                    </div>
                                                </div>
                                                <div class="modal-footer justify-content-between">
                                                    <button type="reset" class="btn btn-default" data-dismiss="modal">Close</button>
                                                    <button type="button" id="upload_data_btn" class="btn btn-primary toastsUploadSuccess">Upload</button>
                                                </div>
                                            </form>
                                        </div>
                                        <!-- /.modal-content -->
                                    </div>
                                    <!-- /.modal-dialog -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <t t-call='ojm.portal_footer' />
            <aside class="control-sidebar control-sidebar-dark"></aside>
            <iframe name="frame" id="hidden_frame"></iframe>
        </t>
    </template>

</odoo>